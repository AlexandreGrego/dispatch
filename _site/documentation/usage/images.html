<!doctype html>
<html lang="en-US">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Images and Base Images | Dispatch Serverless Framework</title>
<meta property="og:title" content="Images and Base Images" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Images and Base Images" />
<meta property="og:description" content="Images and Base Images" />
<link rel="canonical" href="http://localhost:4000/dispatch/documentation/usage/images" />
<meta property="og:url" content="http://localhost:4000/dispatch/documentation/usage/images" />
<meta property="og:site_name" content="Dispatch Serverless Framework" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-11T14:24:45-07:00" />
<script type="application/ld+json">
{"name":null,"description":"Images and Base Images","author":null,"@type":"BlogPosting","url":"http://localhost:4000/dispatch/documentation/usage/images","publisher":null,"image":null,"headline":"Images and Base Images","dateModified":"2018-06-11T14:24:45-07:00","datePublished":"2018-06-11T14:24:45-07:00","sameAs":null,"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/dispatch/documentation/usage/images"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/dispatch/assets/node_modules/@clr/icons/clr-icons.min.css">
    <script src="/dispatch/assets/node_modules/@webcomponents/custom-elements/custom-elements.min.js"></script>
    <script src="/dispatch/assets/node_modules/@clr/icons/clr-icons.min.js"></script>
    <script src="/dispatch/assets/node_modules/anchor-js/anchor.js"></script>
    <link rel="stylesheet" href="/dispatch/assets/node_modules/@clr/ui/clr-ui.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
    <link rel="stylesheet" href="/dispatch/assets/css/style.css?v=cd131ece455317a0ce1219b8b78ef55e8e6bf546">
    <meta name="viewport" content="width=device-width">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/dispatch/assets/images/dispatch.ico/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/dispatch/assets/images/dispatch.ico/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/dispatch/assets/images/dispatch.ico/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/dispatch/assets/images/dispatch.ico/favicon-16x16.png" sizes="16x16" />
    <meta name="application-name" content="&nbsp;"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/dispatch/assets/images/dispatch.ico/mstile-144x144.png" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
    <body>
        <clr-main-container class="main-container">
        <clr-header class="header-6 header">
    <button class="header-hamburger-trigger" type="button">
        <span></span>
    </button>

    <div class="branding">
        <a class="logo-and-title" routerlink="/" href="http://github.com/vmware/dispatch">
            <!-- <span class="clr-icon clarity-logo"></span>
            <span class="title">Project Dispatch</span> -->
            <img class="dispatch-logo" src="/dispatch/assets/images/logo-small-200.png">
        </a>
    </div>
    <div class="divider"></div>
    <div class="header-nav clr-nav-level-1">
        <a class="nav-link " id="home-link" routerlink="/" routerlinkactive="active" href="/dispatch/"><span class="nav-text">Home</span></a>
        <a class="nav-link active" routerlink="/documentation" routerlinkactive="active" href="/dispatch/documentation/front/overview"><span class="nav-text">Documentation</span></a>
        <a class="nav-link " routerlink="/code" routerlinkactive="active" href="/dispatch/code"><span class="nav-text">Code</span></a>
        <a class="nav-link " routerlink="/community" routerlinkactive="active" href="/dispatch/community"><span class="nav-text">Community</span></a>
        <a class="nav-link " routerlink="/news" routerlinkactive="active" href="/dispatch/news"><span class="nav-text">What's New</span></a>
    </div>
    <div class="settings">
        <iframe class="github-btn" frameborder="0" height="20px" scrolling="0" src="https://ghbtns.com/github-btn.html?user=vmware&repo=dispatch&type=star&count=true" width="170px"></iframe>
    </div>

    <button class="header-overflow-trigger" type="button">
        <span></span>
    </button>
    <div class="header-backdrop"></div>
</clr-header>

            <documentation class="content-container"><router-outlet></router-outlet>
                <div class="content-area">
                    <section class="dox-content">
                    <h1 id="images-and-base-images">Images and Base Images</h1>

<p>Before a function can be created, it needs a runtime.  Images and Base Images provide the OS, language runtime and
dependencies required for functions.</p>

<h2 id="base-images">Base Images</h2>

<p>Base Images are intended to provide the core language functionaity.  This generally consists of the OS (Photon) and
the language runtime.  Additionally, base images contain code to interact with the FaaS (a small web server).</p>

<p>The Base Images supplied by Dispatch can be found on DockerHub under the
<a href="https://hub.docker.com/u/dispatchframework/">dispatchframework</a> organization.  These images contain the bare minimum
required to run a function for a given language.  If you have global system or language specific dependencies, you can
simply extend the base images by creating a new Docker image.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mkdir my-python-base
$ cd my-python-base
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat &lt;&lt; EOF &gt; Dockerfile
FROM dispatchframework/python3-base:0.0.7

RUN pip3 install requests
EOF
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker build -t berndtj/my-python-base:0.0.1 .
$ docker push berndtj/my-python-base:0.0.1
</code></pre></div></div>

<h3 id="adding-a-base-image">Adding a Base Image</h3>

<p>Base Images can be added through the <code class="highlighter-rouge">create base-image</code> command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dispatch create base-image my-python-base berndtj/my-python-base:0.0.1 --language python3
</code></pre></div></div>

<p>Or via generic <code class="highlighter-rouge">create</code> (multiple resources may be created at once):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat &lt;&lt; EOF &gt; base-images.yaml
kind: BaseImage
name: my-python-base
dockerUrl: berndtj/my-python-base:0.0.1
language: python3
tags:
  - key: role
    value: docs
EOF
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dispatch create -f base-images.yaml
</code></pre></div></div>

<h3 id="checking-status">Checking Status</h3>

<p>Before a Base Image is <code class="highlighter-rouge">READY</code>, the server will ensure that it can pull the image.  Verify the image is <code class="highlighter-rouge">READY</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dispatch get base-image my-python-base
       NAME      |             URL              | STATUS |         CREATED DATE
------------------------------------------------------------------------------------
  my-python-base | berndtj/my-python-base:0.0.1 | READY  | Fri Jun  8 14:31:48 PDT 2018
</code></pre></div></div>

<p>If the base image is in <code class="highlighter-rouge">ERROR</code> state, check the reason:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dispatch get base-image does-not-exist --json | jq .reason
[
  "error when pulling image berndtj/does-not-exist:0.0.1: Error response from daemon: pull access denied for berndtj/does-not-exist, repository does not exist or may require 'docker login'"
]

</code></pre></div></div>

<h2 id="images">Images</h2>

<p>Images represent the function runtime.  Functions usually have dependencies, such as libraries useful for a given task.
While dependencies can be added to the base-images, doing so via images is more managed and controlled.  The distinction
comes down to roles.  Administrators should manage the catalog of base-images, but developers should manage images. Base
images are built externally via Dockerfiles and may contain anything, whereas images are built via the image service
within Dispatch.  Rather than having access to the Dockerfile, developers may manage image contents through manifests.
By managing images more tightly, Dispatch can provide a catalog of software installed on each image.  This is a
compromise to allow developers to easily add dependencies while maintaining some control and security.</p>

<h3 id="adding-an-image">Adding an Image</h3>

<p>In order to create an image which includes the popular python data analysis library, Pandas, first simply create a standard
<code class="highlighter-rouge">requirements.txt</code> file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat &lt;&lt; EOF &gt; requirements.txt
pandas==0.23.0
EOF
</code></pre></div></div>

<p>Images can be added through the <code class="highlighter-rouge">create image</code> command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dispatch create image my-pandas my-python-base --runtime-deps requirements.txt
</code></pre></div></div>

<p>Or via generic <code class="highlighter-rouge">create</code> (multiple resources may be created at once):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat &lt;&lt; EOF &gt; images.yaml
kind: Image
name: my-pandas
baseImageName: my-python-base
runtimeDependencies:
  manifest: '@requirements.txt'
tags:
  - key: role
    value: docs
EOF
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ dispatch create -f images.yaml
</code></pre></div></div>

                    </section>
                </div>

                <nav class="sidenav clr-nav-level-2">
                    <section class="sidenav-content">
                    

                    
                    
                        <!-- front section is top level and has no label -->
                        <section class="nav-group collapsible">

                        
                            <ul class="nav-list">
                                <documentation-nav-links type="">
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/front/overview">Overview</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/front/roadmap">Roadmap</a></li>
                                
                                
                                </documentation-nav-links>
                            </ul>
                        </section>
                    
                    
                    
                        <!-- front section is top level and has no label -->
                        <section class="nav-group collapsible">

                        
                        
                            
                            <input id="Guides" type="checkbox" checked>
                            
                            <label for="Guides">Guides</label>
                        
                        
                            <ul class="nav-list">
                                <documentation-nav-links type="Guides">
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/building">Building</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/built-in-event-drivers">Built In Event Drivers</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/custom-event-drivers">Custom Event Drivers</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/docker-for-mac">Docker For Mac</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/gke">Gke</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/minikube">Minikube</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/quickstart">Quickstart</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/setup-authentication">Setup Authentication</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/setup-service-acccount-authentication">Setup Service Acccount Authentication</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/troubleshooting">Troubleshooting</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/guides/working-with-events">Working With Events</a></li>
                                
                                
                                </documentation-nav-links>
                            </ul>
                        </section>
                    
                    
                    
                        <!-- front section is top level and has no label -->
                        <section class="nav-group collapsible">

                        
                        
                            
                            <input id="posts" type="checkbox" checked>
                            
                            <label for="posts">Posts</label>
                        
                        
                            <ul class="nav-list">
                                <documentation-nav-links type="">
                                
                                
                                    <li><a class="nav-link" href="/dispatch/2018/05/23/v0-1-15-release.html">v0.1.15 Dispatch Release</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/2018/06/06/v0-1-16-release.html">v0.1.16 Dispatch Release</a></li>
                                
                                
                                </documentation-nav-links>
                            </ul>
                        </section>
                    
                    
                    
                        <!-- front section is top level and has no label -->
                        <section class="nav-group collapsible">

                        
                        
                            
                            <input id="Specifications" type="checkbox" checked>
                            
                            <label for="Specifications">Specifications</label>
                        
                        
                            <ul class="nav-list">
                                <documentation-nav-links type="Specifications">
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/api-gateway">Api Gateway</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/application">Application</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/development">Development</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/dispatch">Dispatch</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/error-handling">Error Handling</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/event-gateway">Event Gateway</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/event-manager">Event Manager</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/function-gateway">Function Gateway</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/function-schema-validation">Function Schema Validation</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/identity-management">Identity Management</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/image-manager">Image Manager</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/language-support">Language Support</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/rest-api">Rest Api</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/secrets-store">Secrets Store</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/service-manager">Service Manager</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/specs/terminology">Terminology</a></li>
                                
                                
                                </documentation-nav-links>
                            </ul>
                        </section>
                    
                    
                    
                        <!-- front section is top level and has no label -->
                        <section class="nav-group collapsible">

                        
                        
                            
                            <input id="Usage" type="checkbox">
                            
                            <label for="Usage">Usage</label>
                        
                        
                            <ul class="nav-list">
                                <documentation-nav-links type="Usage">
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/usage/api">API Endpoints</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/usage/event-drivers">Events Drivers and Subscriptions</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/usage/functions">Functions</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/usage/iam">Roles and Policies</a></li>
                                
                                
                                
                                    <li><a class="nav-link active" routerlinkactive="active" href="/dispatch/documentation/usage/images">Images and Base Images</a></li>
                                
                                
                                
                                    <li><a class="nav-link" href="/dispatch/documentation/usage/services">Services Integration</a></li>
                                
                                
                                </documentation-nav-links>
                            </ul>
                        </section>
                    
                    
                    </section>
                </nav>
            </documentation>
        <footer></footer>
<script>
    anchors.add();
</script>
<script src="/dispatch/assets/js/scale.fix.js"></script>
        </clr-main-container>
    </body>
</html>